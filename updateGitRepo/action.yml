name: "Update Contents of a git directory"
description: "Fetch all release names given a path to the directory that contains release configs"
inputs:
  target-repo:
    description: "name of the repo to report to, will create a folder packageVersionReports in the target repo"
    required: true
  source-dir:
     description: "The path to the source directory, whose contents should be copied over"
     required: true
     default: "_data"
  target-dir:
     description: "The target directory which the source directory is copied over"
     required: true
     default: "_data"
  commit-message:
     description: "The target directory which the source directory is copied over"
     required: false
  path-to-all-release-name-file:
    description: "The path to the output file generated by fetchAllReleaseNames"
    default: "all-releases.json"
  update-release-names:
     description: "Update release names"
     required: false
     default: "true"
  gh_token:
    description: "github token to use for commiting to repo"
    required: true


runs:
  using: "composite"
  steps:

    - run: |
        git config --global --add safe.directory $GITHUB_WORKSPACE
        export GH_TOKEN=${{inputs.gh_token}}
        echo "GH_TOKEN=$GH_TOKEN" >> $GITHUB_ENV
      shell: bash

    - run: |
        node $GITHUB_ACTION_PATH/updateGitRepo.js ${{ inputs.gh_token }} ${{ github.repository }} ${{ github.ref_name }} ${{ inputs.target-repo }}  _data _data "${{inputs.commit-message }}"  ${{inputs.update-release-names }} ${{inputs.path-to-all-release-name-file }} 
      shell: bash
      id: updateAllReleaseNames

